{
  "policies": [
    {
      "name": "enforce-environment-tag",
      "properties": {
        "displayName": "Enforce allowed values for Environment tag",
        "mode": "Indexed",
        "description": "Only allows Production, Development, or Test as values for the Environment tag.",
        "parameters": {
          "allowedValues": {
            "type": "Array"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "tags['Environment']",
                "exists": true
              },
              {
                "field": "tags['Environment']",
                "notIn": "[parameters('allowedValues')]"
              }
            ]
          },
          "then": {
            "effect": "deny"
          }
        }
      }
    },
    {
      "name": "enforce-compliance-tag",
      "properties": {
        "displayName": "Enforce allowed values for ComplianceRequirement tag",
        "mode": "Indexed",
        "description": "Only allows Standard or None as values for the ComplianceRequirement tag.",
        "parameters": {
          "allowedValues": {
            "type": "Array"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "tags['ComplianceRequirement']",
                "exists": true
              },
              {
                "field": "tags['ComplianceRequirement']",
                "notIn": "[parameters('allowedValues')]"
              }
            ]
          },
          "then": {
            "effect": "deny"
          }
        }
      }
    },
    {
      "name": "enforce-drtier-tag",
      "properties": {
        "displayName": "Enforce allowed values for DRTier tag",
        "mode": "Indexed",
        "description": "Only allows None, Tier0 through Tier4 as values for the DRTier tag.",
        "parameters": {
          "allowedValues": {
            "type": "Array"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "tags['DRTier']",
                "exists": true
              },
              {
                "field": "tags['DRTier']",
                "notIn": "[parameters('allowedValues')]"
              }
            ]
          },
          "then": {
            "effect": "deny"
          }
        }
      }
    },
    {
      "name": "enforce-schedule-tag",
      "properties": {
        "displayName": "Enforce allowed values for Schedule tag",
        "mode": "Indexed",
        "description": "Only allows None, Stargate, or AlwaysOn as values for the Schedule tag.",
        "parameters": {
          "allowedValues": {
            "type": "Array"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "tags['Schedule']",
                "exists": true
              },
              {
                "field": "tags['Schedule']",
                "notIn": "[parameters('allowedValues')]"
              }
            ]
          },
          "then": {
            "effect": "deny"
          }
        }
      }
    },
    {
      "name": "enforce-primarycontact-pattern",
      "properties": {
        "displayName": "Enforce email domain for PrimaryContact tag",
        "mode": "Indexed",
        "description": "PrimaryContact tag must end with @warehouser.com.",
        "parameters": {
          "suffixPattern": {
            "type": "String"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "tags['PrimaryContact']",
                "exists": true
              },
              {
                "field": "tags['PrimaryContact']",
                "notLike": "[parameters('suffixPattern')]"
              }
            ]
          },
          "then": {
            "effect": "deny"
          }
        }
      }
    },
    {
      "name": "audit-other-tags",
      "properties": {
        "displayName": "Audit other tag presence",
        "mode": "Indexed",
        "description": "Audits the presence of optional tags like ApplicationName, Business, ConfidentialityLevel, CostCenter, RBACTeam, Sector, and Workgroup.",
        "policyRule": {
          "if": {
            "anyOf": [
              { "field": "tags['ApplicationName']", "exists": false },
              { "field": "tags['Business']", "exists": false },
              { "field": "tags['ConfidentialityLevel']", "exists": false },
              { "field": "tags['CostCenter']", "exists": false },
              { "field": "tags['RBACTeam']", "exists": false },
              { "field": "tags['Sector']", "exists": false },
              { "field": "tags['Workgroup']", "exists": false }
            ]
          },
          "then": {
            "effect": "audit"
          }
        }
      }
    }
  ]
}
