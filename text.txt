# List of subscriptions
$subscriptions = @(
    "subscription-id-1",
    "subscription-id-2",
    "subscription-id-3",
    "subscription-id-4",
    "subscription-id-5",
    "subscription-id-6",
    "subscription-id-7"
)

# Array to hold the results
$results = @()

foreach ($subscriptionId in $subscriptions) {
    # Set the current subscription context
    Set-AzContext -SubscriptionId $subscriptionId

    # Get all Function Apps in the current subscription
    $functionApps = Get-AzWebApp -FunctionApp

    foreach ($functionApp in $functionApps) {
        # Get the current minimum TLS version for the Function App
        $config = Get-AzWebAppConfig -ResourceGroupName $functionApp.ResourceGroup -Name $functionApp.Name

        # Create a custom object to store the information
        $result = [PSCustomObject]@{
            FunctionAppName = $functionApp.Name
            SubscriptionId  = $subscriptionId
            ResourceGroup   = $functionApp.ResourceGroup
            MinimumTlsVersion = $config.MinTlsVersion
        }

        # Add the result to the array
        $results += $result
    }
}

# Define the CSV file path
$csvFilePath = "C:\path\to\functionAppsTlsVersions.csv"

# Export the results to a CSV file
$results | Export-Csv -Path $csvFilePath -NoTypeInformation

# Output the location of the CSV file
Write-Output "Results exported to $csvFilePath"